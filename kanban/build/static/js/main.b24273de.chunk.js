(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,,,function(e,t,a){e.exports=a(17)},,,,,,function(e,t,a){e.exports=a.p+"/art-kudashev.github.io/kanban/build/static/media/plus.6cb6e5fc.svg"},function(e,t,a){e.exports=a.p+"/art-kudashev.github.io/kanban/build/static/media/cross.5fe0db66.svg"},function(e,t,a){},function(e,t,a){"use strict";function g(e){var t=h.a.createElement("div",{className:"column-title"},h.a.createElement("div",{className:"column-title__text title",onClick:e.openChangeForm,"data-value":e.title},e.title),h.a.createElement("button",{className:"button-delete",title:"Удалить список",onClick:function(){return e.deleteColumn(e.columnId)}},h.a.createElement("img",{src:e.imgSrc,alt:"Изображение"})));return e.title?t:null}function c(e){return h.a.createElement("div",{className:"column-task-list__item",id:e.taskId,"data-value":e.text},h.a.createElement("div",{className:"column-task-list__item-text task",id:e.taskId,onClick:e.openChangeForm},e.text),h.a.createElement("button",{className:"button-delete",title:"Удалить задачу",onClick:function(){return e.deleteTask(e.columnId,e.taskId)}},h.a.createElement("img",{src:e.imgSrc,alt:"Изображение"})))}function p(e){return h.a.createElement("div",{className:e.class,onClick:e.openForm},h.a.createElement("img",{src:e.imgSrc,alt:"Изображение"}),h.a.createElement("span",null,e.text))}function f(e){return h.a.createElement("div",{className:e.class},"textarea"===e.tag?h.a.createElement("textarea",{className:"textfield task",placeholder:e.textfieldPlaceholder,ref:e.textfieldRef}):h.a.createElement("input",{className:"textfield title",placeholder:e.columnTextfieldPlaceholder,ref:e.textfieldRef}),h.a.createElement("div",{className:"column-add-form__buttons"},h.a.createElement("button",{className:"column-add-form__buttons-add",onClick:e.addValue},e.text),h.a.createElement("button",{className:"button-close",title:"Закрыть поле ввода",onClick:e.openForm},h.a.createElement("img",{src:e.imgSrc,alt:"Изображение"}))))}a.r(t);var n,l,i=a(1),o=a(2),r=a(4),s=a(3),d=a(5),m=a(0),h=a.n(m),u=a(7),k=a.n(u),v=(l=m.Component,Object(d.a)(C,l),Object(o.a)(C,[{key:"render",value:function(){var e=this.props,t=e.tasks,a=e.openChangeForm,n=e.deleteTask,l=e.columnId,o=e.imgSrc,i=e.id,r=[];return t&&(r=t.map(function(e,t){return h.a.createElement(c,{text:e.text,key:t,taskId:t,columnId:l,openChangeForm:a,deleteTask:n,imgSrc:o})})),h.a.createElement("div",{className:"column-task-list",id:i},r)}}]),C),b=a(14),E=a(15),I=(n=m.Component,Object(d.a)(w,n),Object(o.a)(w,[{key:"render",value:function(){var e=this.state.addFormOpen,t=this.props,a=t.tasks,n=t.title,l=t.deleteColumnTask,o=t.deleteColumn,i=t.id,r=n?"textarea":"input",c=n?"Добавить еще одну карточку":"Добавить еще одну колонку",s=n?"Добавить карточку":"Добавить колонку",d=n?"Введите название карточки":"Введите название колонки",m=e?"column-add-btn hidden":"column-add-btn",u=e?"column-add-form":"column-add-form hidden";return h.a.createElement("div",{className:"column"},h.a.createElement(g,{openChangeForm:this.openChangeForm,deleteColumn:o,imgSrc:E,title:n,columnId:i}),n?h.a.createElement(v,{key:Math.random(),id:i,tasks:a,columnId:i,openChangeForm:this.openChangeForm,deleteTask:l,imgSrc:E}):null,h.a.createElement(p,{class:m,text:c,openForm:this.openAddForm,imgSrc:b}),h.a.createElement(f,{tag:r,class:u,textfieldPlaceholder:d,text:s,textfieldRef:this.textfieldRef,addValue:this.addValue,openForm:this.openAddForm,imgSrc:E}))}}]),w),S=document.createElement("div");function w(){var e,o;Object(i.a)(this,w);for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];return(o=Object(r.a)(this,(e=Object(s.a)(w)).call.apply(e,[this].concat(a)))).textfieldRef=h.a.createRef(),o.state={addFormOpen:!1},o.openAddForm=function(){var e=o.textfieldRef.current;e.value="",e.focus(),o.setState(function(e){return{addFormOpen:!e.addFormOpen}})},o.openChangeForm=function(e){if("true"!==e.target.dataset.clicked){o.props.stopDrag();var t=e.target;t.dataset.clicked=!0,t.dataset.value=t.innerText.trim();var a=null;t.classList.contains("title")?a=o.replaceElement(t,"input","textfield title"):t.classList.contains("task")&&(a=o.replaceElement(t,"textarea","textfield task")),a.focus(),o.changeValueFunc=function(){return o.changeValue(a,t)},window.addEventListener("click",o.changeValueFunc)}},o.addValue=function(){var e=o.textfieldRef.current,t=o.props.id,a=e.value.trim();a&&(o.openAddForm(),e.classList.contains("task")&&o.props.addColumnTask(a,t),e.classList.contains("title")&&o.props.addNewColumn(a,t),e.value="")},o.changeValue=function(e,t){if(document.activeElement!==e){var a=o.props.id,n=e.id,l=e.value.trim();""===l?e.value=t.dataset.value:(e.classList.contains("title")&&o.props.updateColumnTitle(l,a),e.classList.contains("task")&&o.props.updateColumnTask(l,a,n)),e.dataset.clicked=!1,e.dataset.value=l,o.replaceElement(e,"div",t.className),o.props.startDrag(),window.removeEventListener("click",o.changeValueFunc)}},o.replaceElement=function(e,t){var a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=document.createElement(t);return n.dataset.clicked=e.dataset.clicked,n.dataset.value=e.dataset.value,a&&(n.className=a),!1===n.classList.contains("title")&&(n.id=e.id),n.addEventListener("click",o.openChangeForm),"INPUT"===e.tagName||"TEXTAREA"===e.tagName?n.innerText=e.value:n.value=e.innerText,e.replaceWith(n),n},o}function C(){return Object(i.a)(this,C),Object(r.a)(this,Object(s.a)(C).apply(this,arguments))}function y(e){return h.a.createElement("div",{id:"main-wrap__background-image-block",ref:e.backgroundImageBlockRef})}function x(e){return h.a.createElement("div",{id:"main-wrap-upload__background"},h.a.createElement("div",{className:"label-delete"},h.a.createElement("label",{title:"Удалить фон",className:"main-wrap-upload__background-label",onClick:e.deleteBackgroundImage},"+")),h.a.createElement("div",{className:"label-add"},h.a.createElement("label",{title:"Загрузить фон",htmlFor:"main-wrap-upload__background-input",className:"main-wrap-upload__background-label"},"+")),h.a.createElement("input",{type:"file",id:"main-wrap-upload__background-input",onChange:e.addBackgroundImage}))}S.id="column-task-list__item-shadow";var O,T,N=(T=m.Component,Object(d.a)(B,T),Object(o.a)(B,[{key:"componentDidMount",value:function(){this.start()}},{key:"render",value:function(){var a=this,e=this.props.columns;return h.a.createElement(m.Fragment,null,e?e.map(function(e,t){return h.a.createElement(I,Object.assign({key:t,id:t,title:e.title,tasks:e.tasks,startDrag:a.start,stopDrag:a.stop},a.props))}):h.a.createElement(I,Object.assign({key:0,id:0},this.props)))}}]),B),R=(a(16),O=m.Component,Object(d.a)(F,O),Object(o.a)(F,[{key:"componentDidMount",value:function(){var e=this.backgroundImageBlockRef.current,t=localStorage.getItem("backgroundImageURL");t&&(e.style.background="url(".concat(t,")"),e.style.backgroundSize="100% 100%")}},{key:"render",value:function(){var e=this.state.columns;return h.a.createElement(m.Fragment,null,h.a.createElement(N,{columns:e,addNewColumn:this.addNewColumn,addColumnTask:this.addColumnTask,updateColumnTasks:this.updateColumnTasks,updateColumnTitle:this.updateColumnTitle,updateColumnTask:this.updateColumnTask,deleteColumnTask:this.deleteColumnTask,deleteColumn:this.deleteColumn}),h.a.createElement(y,{backgroundImageBlockRef:this.backgroundImageBlockRef}),h.a.createElement(x,{addBackgroundImage:this.addBackgroundImage,deleteBackgroundImage:this.deleteBackgroundImage,backgroundImageBlockRef:this.backgroundImageBlockRef}))}}]),F);function F(){var e,l;Object(i.a)(this,F);for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];return(l=Object(r.a)(this,(e=Object(s.a)(F)).call.apply(e,[this].concat(a)))).backgroundImageBlockRef=h.a.createRef(),l.state={columns:JSON.parse(localStorage.getItem("columns")),backgroundImageURL:localStorage.getItem("backgroundImageURL")},l.addNewColumn=function(e,t){var a=Object.assign([],JSON.parse(localStorage.getItem("columns"))),n={title:e,tasks:[]};a.splice(t,1,n),a.push({}),localStorage.setItem("columns",JSON.stringify(a)),l.setState({columns:a})},l.addColumnTask=function(e,t){var a=Object.assign([],JSON.parse(localStorage.getItem("columns")));a[t].tasks.push({text:e}),localStorage.setItem("columns",JSON.stringify(a)),l.setState({columns:a})},l.updateColumnTitle=function(e,t){var a=Object.assign([],JSON.parse(localStorage.getItem("columns")));a[t]&&a[t].title&&(a[t].title=e,localStorage.setItem("columns",JSON.stringify(a)),l.setState({columns:a}))},l.updateColumnTasks=function(e,t){var a=Object.assign([],JSON.parse(localStorage.getItem("columns")));a[t]&&(a[t].tasks=e,localStorage.setItem("columns",JSON.stringify(a)),l.setState({columns:a}))},l.updateColumnTask=function(e,t,a){var n=Object.assign([],JSON.parse(localStorage.getItem("columns")));n[t]&&1<n.length&&n[t].tasks[a]&&(n[t].tasks[a].text=e,localStorage.setItem("columns",JSON.stringify(n)),l.setState({columns:n}))},l.deleteColumnTask=function(e,t){var a=Object.assign([],JSON.parse(localStorage.getItem("columns")));a[e].tasks.splice(t,1),localStorage.setItem("columns",JSON.stringify(a)),l.setState({columns:a})},l.deleteColumn=function(e){var t=Object.assign([],JSON.parse(localStorage.getItem("columns")));t.splice(e,1),localStorage.setItem("columns",JSON.stringify(t)),l.setState({columns:t})},l.addBackgroundImage=function(e){var t=e.target.files[0],a=new FileReader,n=l.backgroundImageBlockRef.current;t.type.startsWith("image/")&&(a.onload=function(){n.style.background="url(".concat(a.result,")"),n.style.backgroundSize="100% 100%",localStorage.setItem("backgroundImageURL",JSON.stringify(a.result)),l.setState({backgroundImageURL:a.result})},a.readAsDataURL(t))},l.deleteBackgroundImage=function(){l.backgroundImageBlockRef.current.style.background="none",localStorage.setItem("backgroundImageURL",""),l.setState({backgroundImageURL:""})},l}function B(e){var E;return Object(i.a)(this,B),(E=Object(r.a)(this,Object(s.a)(B).call(this,e))).start=function(){E.isMobile?(window.addEventListener("touchstart",E.dragStart),window.addEventListener("touchmove",E.drag),window.addEventListener("touchend",E.dragEnd)):(window.addEventListener("mousedown",E.dragStart),window.addEventListener("mousemove",E.drag),window.addEventListener("mouseup",E.dragEnd))},E.stop=function(){E.isMobile?(window.removeEventListener("touchstart",E.dragStart),window.removeEventListener("touchmove",E.drag),window.removeEventListener("touchend",E.dragEnd)):(window.removeEventListener("mousedown",E.dragStart),window.removeEventListener("mousemove",E.drag),window.removeEventListener("mouseup",E.dragEnd))},E.dragStart=function(e){if(E.isMobile){if(0!==e.which||1<e.touches.length||!e.target.closest(".".concat(E.dragItemClass)))return}else if(1!==e.which||!e.target.closest(".".concat(E.dragItemClass)))return;var t=E.dragItem;t.item=e.target.closest(".".concat(E.dragItemClass)),t.item.style.width=t.item.getBoundingClientRect().width+"px",t.item.style.height=t.item.getBoundingClientRect().height+"px",E.isMobile?E.shift={x:t.item.getBoundingClientRect().left-e.targetTouches[0].clientX,y:t.item.getBoundingClientRect().top-e.targetTouches[0].clientY}:E.shift={x:t.item.getBoundingClientRect().left-e.clientX,y:t.item.getBoundingClientRect().top-e.clientY}},E.drag=function(e){if(E.dragItem.item){E.checkForScroll(e,"window","horizontal"),E.checkForScroll(e,"column","vertical");var t=E.dragItem.item,a=E.dragAreaClass,n=E.dragItemClass,l=E.findElement(e,a),o=E.findElement(e,n),i=E.shift,r=E.isMobile?e.targetTouches[0].clientX:e.clientX,c=E.isMobile?e.targetTouches[0].clientY:e.clientY;if(t.style.position="fixed",t.style.top=c+i.y+"px",t.style.left=r+i.x+"px",t.style.transform="rotate(5deg)",t.style.pointerEvents="none",t.style.zIndex=2,E.dragItem.area){var s=!0,d=!1,m=void 0;try{for(var u,g=E.dragItem.area.children[Symbol.iterator]();!(s=(u=g.next()).done);s=!0){var p=u.value;p.id===S.id&&!1===E.collideItems(t,p)&&p.remove()}}catch(e){d=!0,m=e}finally{try{s||null==g.return||g.return()}finally{if(d)throw m}}}if(l){var f=l;f.children.length<=1&&(f.appendChild(S),S.style.height=t.style.height,E.dragItem.shadow=f.children.namedItem(S.id),E.dragItem.area=f)}if(o){var h=o,k=h.parentElement,v=h.previousElementSibling,b=h.nextElementSibling;if("top"===E.getCollideDirection(h)&&E.collideItems(t,h)){if(v&&v.id===S.id)return;b&&b.id===S.id&&b.remove(),k.insertBefore(S,h)}if("bottom"===E.getCollideDirection(h)&&E.collideItems(t,h)){if(b&&b.id===S.id)return;v&&v.id===S.id&&v.remove(),E.insertAfter(S,h)}S.style.height=t.style.height,E.dragItem.shadow=k.children.namedItem(S.id),E.dragItem.area=k,E.dragItem.collisionItem=h}}},E.dragEnd=function(e){if(E.dragItem.item){var t=E.dragItem.item;if(S&&S.parentElement){var a=t.parentElement.id,n=t.id,l=S.parentElement.id,o=[];if(t.setAttribute("style","none"),S.replaceWith(t),0===t.parentElement.children.length)o.push({text:t.dataset.value});else{var i=!0,r=!1,c=void 0;try{for(var s,d=t.parentElement.children[Symbol.iterator]();!(i=(s=d.next()).done);i=!0){var m=s.value;m!==S&&o.push({text:m.dataset.value})}}catch(e){r=!0,c=e}finally{try{i||null==d.return||d.return()}finally{if(r)throw c}}}E.props.deleteColumnTask(a,n),E.props.updateColumnTasks(o,l)}else t.setAttribute("style","none");E.dragItem={}}},E.checkForScroll=function(e,t,a){"window"===t&&clearTimeout(E.windowScrollId),"column"===t&&clearTimeout(E.columnScrollId),E.adjustWindowScroll(e,t,a)&&("window"===t&&(E.windowScrollId=setTimeout(function(){return E.checkForScroll(e,t,a)},20)),"column"===t&&(E.columnScrollId=setTimeout(function(){return E.checkForScroll(e,t,a)},20)))},E.adjustWindowScroll=function(e,t,a){if(E.dragItem.item){var n=E.dragItem.item.getBoundingClientRect();if("window"===t&&"horizontal"===a){var l=E.isMobile?10:30,o=document.documentElement.clientWidth-document.documentElement.clientWidth,i=document.documentElement.clientWidth;if(n.right+20>i)return document.documentElement.scrollLeft+=l,!0;if(n.left-20<o)return document.documentElement.scrollLeft-=l,!0}if("column"===t&&"vertical"===a){var r=E.findElement(e,"column-title"),c=E.findElement(e,"column-add-btn");if(r){var s=r.getBoundingClientRect();if(e.clientY>s.top&&e.clientY<s.bottom)return r.parentElement.scrollTop-=5,!0}if(c){var d=c.getBoundingClientRect();if(e.clientY>d.top&&e.clientY<d.bottom)return c.parentElement.scrollTop+=5,!0}}return!1}},E.findElement=function(e,t){for(var a={x:E.isMobile?e.targetTouches[0].clientX:e.clientX,y:E.isMobile?e.targetTouches[0].clientY:e.clientY},n=document.elementFromPoint(a.x,a.y);n&&n!==document;n=n.parentElement)if(n.classList.contains(t)||n.id===t)return n},E.getCollideDirection=function(e){var t=e.getBoundingClientRect(),a=window.event,n=(E.isMobile?a.targetTouches[0].clientX:a.clientX,E.isMobile?a.targetTouches[0].clientY:a.clientY);return n>t.top&&n<t.top+t.height/2?"top":n<t.bottom&&n>t.top+t.height/2?"bottom":void 0},E.collideItems=function(e,t){var a=e.getBoundingClientRect(),n=t.getBoundingClientRect();return!(a.top+a.height<n.top||a.top>n.top+n.height||a.left+a.width/2<n.left||a.left+a.width/2>n.right)},E.insertAfter=function(e,t){return t.parentElement.insertBefore(e,t.nextElementSibling)},E.dragItem={},E.shift={},E.dragItemClass="column-task-list__item",E.dragAreaClass="column-task-list",E.isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/.test(navigator.userAgent),E}k.a.render(h.a.createElement(R,null),document.getElementById("main-wrap"))}],[[8,1,2]]]);
